from app.extractors import WtaExtractor
import pytest


class TestWtaExtractor:

    @pytest.fixture
    def extractor(self):
        return WtaExtractor()

    @pytest.mark.asyncio
    async def test_extract_uswx10(self, extractor):
        assert await extractor.extract(USWX10) == {}


USWX10 = b'''\
<uswx:WindsAndTemperaturesAloftForecast gml:id="wta-666c8184-bb32-4e8c-b95d-5384084a3f1f" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:uswx="http://nws.weather.gov/schemas/USWX/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://nws.weather.gov/schemas/USWX/1.0 http://nws.weather.gov/schemas/USWX/1.0/FBUS/schema/wndtmpalft.xsd"><uswx:issuingOffice>National Centers for Environmental Prediction</uswx:issuingOffice><uswx:resultTime gml:id="wta-f7aa4fd2-d6ad-4684-ba3f-20cfe3da4ae0"><gml:timePosition>2020-06-14T06:00:00</gml:timePosition></uswx:resultTime><uswx:validTime gml:id="wta-b5fb94bd-5651-4101-ad23-cae4adf2a356"><gml:begin><gml:TimeInstant gml:id="wta-01986df5-f39e-4ea6-9356-31c9edb6e147"><gml:timePosition>2020-06-14T03:00:00</gml:timePosition></gml:TimeInstant></gml:begin><gml:end><gml:TimeInstant gml:id="wta-5b574b2b-25b4-47b0-8dfb-52254605c095"><gml:timePosition>2020-06-14T12:00:00</gml:timePosition></gml:TimeInstant></gml:end></uswx:validTime><uswx:WTForecastResults><uswx:SamplingAtPoint><uswx:samplingPointIdentifier>ITO</uswx:samplingPointIdentifier><uswx:samplingPointLocation><gml:Point axisLabels="latitude longitude" gml:id="fbus-ITO-Location" srsDimension="2" srsName="urn:ogc:def:crs:EPSG::4326" uomLabels="degree degree"><gml:pos>19.717 -154.950</gml:pos></gml:Point></uswx:samplingPointLocation><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">270</uswx:windDirection><uswx:windSpeed uom="kn_i">19</uswx:windSpeed><uswx:temperature uom="Cel">-15</uswx:temperature><uswx:level uom="ft_i">24000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">110</uswx:windDirection><uswx:windSpeed uom="kn_i">10</uswx:windSpeed><uswx:temperature uom="Cel">12</uswx:temperature><uswx:level uom="ft_i">6000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">130</uswx:windDirection><uswx:windSpeed uom="kn_i">11</uswx:windSpeed><uswx:temperature uom="Cel">2</uswx:temperature><uswx:level uom="ft_i">15000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">6</uswx:windSpeed><uswx:level uom="ft_i">2000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">100</uswx:windDirection><uswx:windSpeed uom="kn_i">10</uswx:windSpeed><uswx:temperature uom="Cel">9</uswx:temperature><uswx:level uom="ft_i">12000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">5</uswx:windSpeed><uswx:level uom="ft_i">1500</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">100</uswx:windDirection><uswx:windSpeed uom="kn_i">13</uswx:windSpeed><uswx:level uom="ft_i">3000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">100</uswx:windDirection><uswx:windSpeed uom="kn_i">7</uswx:windSpeed><uswx:temperature uom="Cel">9</uswx:temperature><uswx:level uom="ft_i">9000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">10</uswx:windDirection><uswx:windSpeed uom="kn_i">5</uswx:windSpeed><uswx:temperature uom="Cel">-4</uswx:temperature><uswx:level uom="ft_i">18000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:level uom="ft_i">1000</uswx:level></uswx:WindTempAtLevel></uswx:results></uswx:SamplingAtPoint></uswx:WTForecastResults><uswx:WTForecastResults><uswx:SamplingAtPoint><uswx:samplingPointIdentifier>KOA</uswx:samplingPointIdentifier><uswx:samplingPointLocation><gml:Point axisLabels="latitude longitude" gml:id="fbus-KOA-Location" srsDimension="2" srsName="urn:ogc:def:crs:EPSG::4326" uomLabels="degree degree"><gml:pos>19.733 -155.950</gml:pos></gml:Point></uswx:samplingPointLocation><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">280</uswx:windDirection><uswx:windSpeed uom="kn_i">20</uswx:windSpeed><uswx:temperature uom="Cel">-16</uswx:temperature><uswx:level uom="ft_i">24000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">14</uswx:temperature><uswx:level uom="ft_i">6000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">3</uswx:temperature><uswx:level uom="ft_i">15000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:level uom="ft_i">2000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">7</uswx:temperature><uswx:level uom="ft_i">12000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">6</uswx:windSpeed><uswx:level uom="ft_i">1500</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:level uom="ft_i">3000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">10</uswx:temperature><uswx:level uom="ft_i">9000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">-4</uswx:temperature><uswx:level uom="ft_i">18000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">60</uswx:windDirection><uswx:windSpeed uom="kn_i">5</uswx:windSpeed><uswx:level uom="ft_i">1000</uswx:level></uswx:WindTempAtLevel></uswx:results></uswx:SamplingAtPoint></uswx:WTForecastResults><uswx:WTForecastResults><uswx:SamplingAtPoint><uswx:samplingPointIdentifier>LIH</uswx:samplingPointIdentifier><uswx:samplingPointLocation><gml:Point axisLabels="latitude longitude" gml:id="fbus-LIH-Location" srsDimension="2" srsName="urn:ogc:def:crs:EPSG::4326" uomLabels="degree degree"><gml:pos>21.983 -158.667</gml:pos></gml:Point></uswx:samplingPointLocation><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">300</uswx:windDirection><uswx:windSpeed uom="kn_i">21</uswx:windSpeed><uswx:temperature uom="Cel">-17</uswx:temperature><uswx:level uom="ft_i">24000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">80</uswx:windDirection><uswx:windSpeed uom="kn_i">17</uswx:windSpeed><uswx:temperature uom="Cel">12</uswx:temperature><uswx:level uom="ft_i">6000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">50</uswx:windDirection><uswx:windSpeed uom="kn_i">6</uswx:windSpeed><uswx:temperature uom="Cel">2</uswx:temperature><uswx:level uom="ft_i">15000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">16</uswx:windSpeed><uswx:level uom="ft_i">2000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">100</uswx:windDirection><uswx:windSpeed uom="kn_i">6</uswx:windSpeed><uswx:temperature uom="Cel">8</uswx:temperature><uswx:level uom="ft_i">12000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">16</uswx:windSpeed><uswx:level uom="ft_i">1500</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">17</uswx:windSpeed><uswx:level uom="ft_i">3000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">90</uswx:windDirection><uswx:windSpeed uom="kn_i">11</uswx:windSpeed><uswx:temperature uom="Cel">9</uswx:temperature><uswx:level uom="ft_i">9000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">330</uswx:windDirection><uswx:windSpeed uom="kn_i">9</uswx:windSpeed><uswx:temperature uom="Cel">-6</uswx:temperature><uswx:level uom="ft_i">18000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">14</uswx:windSpeed><uswx:level uom="ft_i">1000</uswx:level></uswx:WindTempAtLevel></uswx:results></uswx:SamplingAtPoint></uswx:WTForecastResults><uswx:WTForecastResults><uswx:SamplingAtPoint><uswx:samplingPointIdentifier>HNL</uswx:samplingPointIdentifier><uswx:samplingPointLocation><gml:Point axisLabels="latitude longitude" gml:id="fbus-HNL-Location" srsDimension="2" srsName="urn:ogc:def:crs:EPSG::4326" uomLabels="degree degree"><gml:pos>21.317 -156.083</gml:pos></gml:Point></uswx:samplingPointLocation><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">290</uswx:windDirection><uswx:windSpeed uom="kn_i">23</uswx:windSpeed><uswx:temperature uom="Cel">-17</uswx:temperature><uswx:level uom="ft_i">24000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">80</uswx:windDirection><uswx:windSpeed uom="kn_i">16</uswx:windSpeed><uswx:temperature uom="Cel">13</uswx:temperature><uswx:level uom="ft_i">6000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">2</uswx:temperature><uswx:level uom="ft_i">15000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">60</uswx:windDirection><uswx:windSpeed uom="kn_i">18</uswx:windSpeed><uswx:level uom="ft_i">2000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">130</uswx:windDirection><uswx:windSpeed uom="kn_i">6</uswx:windSpeed><uswx:temperature uom="Cel">6</uswx:temperature><uswx:level uom="ft_i">12000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">60</uswx:windDirection><uswx:windSpeed uom="kn_i">17</uswx:windSpeed><uswx:level uom="ft_i">1500</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">21</uswx:windSpeed><uswx:level uom="ft_i">3000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">90</uswx:windDirection><uswx:windSpeed uom="kn_i">13</uswx:windSpeed><uswx:temperature uom="Cel">9</uswx:temperature><uswx:level uom="ft_i">9000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">300</uswx:windDirection><uswx:windSpeed uom="kn_i">7</uswx:windSpeed><uswx:temperature uom="Cel">-6</uswx:temperature><uswx:level uom="ft_i">18000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">60</uswx:windDirection><uswx:windSpeed uom="kn_i">16</uswx:windSpeed><uswx:level uom="ft_i">1000</uswx:level></uswx:WindTempAtLevel></uswx:results></uswx:SamplingAtPoint></uswx:WTForecastResults><uswx:WTForecastResults><uswx:SamplingAtPoint><uswx:samplingPointIdentifier>LNY</uswx:samplingPointIdentifier><uswx:samplingPointLocation><gml:Point axisLabels="latitude longitude" gml:id="fbus-LNY-Location" srsDimension="2" srsName="urn:ogc:def:crs:EPSG::4326" uomLabels="degree degree"><gml:pos>20.783 -155.050</gml:pos></gml:Point></uswx:samplingPointLocation><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">100</uswx:windDirection><uswx:windSpeed uom="kn_i">11</uswx:windSpeed><uswx:temperature uom="Cel">10</uswx:temperature><uswx:level uom="ft_i">6000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">-5</uswx:temperature><uswx:level uom="ft_i">15000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">80</uswx:windDirection><uswx:windSpeed uom="kn_i">19</uswx:windSpeed><uswx:level uom="ft_i">2000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">2</uswx:temperature><uswx:level uom="ft_i">12000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">21</uswx:windSpeed><uswx:level uom="ft_i">1500</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">90</uswx:windDirection><uswx:windSpeed uom="kn_i">13</uswx:windSpeed><uswx:temperature uom="Cel">13</uswx:temperature><uswx:level uom="ft_i">3000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">110</uswx:windDirection><uswx:windSpeed uom="kn_i">7</uswx:windSpeed><uswx:temperature uom="Cel">7</uswx:temperature><uswx:level uom="ft_i">9000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">280</uswx:windDirection><uswx:windSpeed uom="kn_i">22</uswx:windSpeed><uswx:temperature uom="Cel">-16</uswx:temperature><uswx:level uom="ft_i">18000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:level uom="ft_i">1000</uswx:level></uswx:WindTempAtLevel></uswx:results></uswx:SamplingAtPoint></uswx:WTForecastResults><uswx:WTForecastResults><uswx:SamplingAtPoint><uswx:samplingPointIdentifier>OGG</uswx:samplingPointIdentifier><uswx:samplingPointLocation><gml:Point axisLabels="latitude longitude" gml:id="fbus-OGG-Location" srsDimension="2" srsName="urn:ogc:def:crs:EPSG::4326" uomLabels="degree degree"><gml:pos>20.900 -155.567</gml:pos></gml:Point></uswx:samplingPointLocation><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">280</uswx:windDirection><uswx:windSpeed uom="kn_i">23</uswx:windSpeed><uswx:temperature uom="Cel">-16</uswx:temperature><uswx:level uom="ft_i">24000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">100</uswx:windDirection><uswx:windSpeed uom="kn_i">17</uswx:windSpeed><uswx:temperature uom="Cel">13</uswx:temperature><uswx:level uom="ft_i">6000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">2</uswx:temperature><uswx:level uom="ft_i">15000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">19</uswx:windSpeed><uswx:level uom="ft_i">2000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">110</uswx:windDirection><uswx:windSpeed uom="kn_i">8</uswx:windSpeed><uswx:temperature uom="Cel">7</uswx:temperature><uswx:level uom="ft_i">12000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">18</uswx:windSpeed><uswx:level uom="ft_i">1500</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">80</uswx:windDirection><uswx:windSpeed uom="kn_i">22</uswx:windSpeed><uswx:level uom="ft_i">3000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">100</uswx:windDirection><uswx:windSpeed uom="kn_i">11</uswx:windSpeed><uswx:temperature uom="Cel">10</uswx:temperature><uswx:level uom="ft_i">9000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel lightAndVariable="true"><uswx:temperature uom="Cel">-5</uswx:temperature><uswx:level uom="ft_i">18000</uswx:level></uswx:WindTempAtLevel></uswx:results><uswx:results><uswx:WindTempAtLevel><uswx:windDirection uom="deg">70</uswx:windDirection><uswx:windSpeed uom="kn_i">16</uswx:windSpeed><uswx:level uom="ft_i">1000</uswx:level></uswx:WindTempAtLevel></uswx:results></uswx:SamplingAtPoint></uswx:WTForecastResults></uswx:WindsAndTemperaturesAloftForecast>
'''  # noqa: E501
