from app.util.splitter import IwxxmSplitter, LineSplitter
from lxml import etree
import pytest
from tests.conftest import compare_xml


class TestIwxxmSplitter:

    @pytest.fixture
    def splitter(self):
        return IwxxmSplitter()

    def test_supports(self, splitter):
        assert splitter.supports(IWXXM)

    @pytest.mark.asyncio
    async def test_split(self, splitter):
        parts = await splitter.split(IWXXM)

        assert len(parts) == 2
        assert compare_xml(etree.fromstring(parts[0]), etree.fromstring(IWXXM_PART1))
        assert compare_xml(etree.fromstring(parts[1]), etree.fromstring(IWXXM_PART2))


class TestLineSplitter:

    @pytest.fixture
    def splitter(self):
        return LineSplitter()

    @pytest.mark.asyncio
    async def test_split(self, splitter):
        parts = await splitter.split(b'abc\n123')
        assert len(parts) == 2
        assert parts[0] == b'abc'
        assert parts[1] == b'123'

        parts = await splitter.split(b'abc\r\n123')
        assert len(parts) == 2
        assert parts[0] == b'abc'
        assert parts[1] == b'123'

        parts = await splitter.split(b'abc\r\r\n123')
        assert len(parts) == 2
        assert parts[0] == b'abc'
        assert parts[1] == b'123'


IWXXM = b'''\
<?xml version='1.0' encoding='UTF-8'?>
<MeteorologicalBulletin gml:id="uuid.f80d5b79-2821-4352-9d0b-1bdf3b9fcf49" xmlns="http://def.wmo.int/collect/2014" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://def.wmo.int/collect/2014 http://schemas.wmo.int/collect/1.2/collect.xsd"><meteorologicalInformation><TAF gml:id="uuid.430664ac-435a-4a15-8119-61fd45ea43ba" permissibleUsage="OPERATIONAL" reportStatus="NORMAL" xmlns="http://icao.int/iwxxm/3.0" xmlns:aixm="http://www.aixm.aero/schema/5.1.1" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://icao.int/iwxxm/3.0 https://schemas.wmo.int/iwxxm/3.0/iwxxm.xsd"><issueTime><gml:TimeInstant gml:id="uuid.fd5b765c-0e03-44af-a020-6a822f0acc6a"><gml:timePosition>2020-06-15T17:29:00Z</gml:timePosition></gml:TimeInstant></issueTime><aerodrome><aixm:AirportHeliport gml:id="uuid.6ccc4302-fded-49a8-85b1-7fd22cb1eb36"><aixm:timeSlice><aixm:AirportHeliportTimeSlice gml:id="uuid.378f76e2-ca0d-4962-a39a-ccf8f247d819"><gml:validTime/><aixm:interpretation>SNAPSHOT</aixm:interpretation><aixm:locationIndicatorICAO>KSBN</aixm:locationIndicatorICAO><aixm:ARP><aixm:ElevatedPoint axisLabels="Lat Long" gml:id="uuid.3423aa30-fcfe-478c-b0da-b132d3df616b" srsDimension="2" srsName="http://www.opengis.net/def/crs/EPSG/0/4326"><gml:pos>41.71 -86.32</gml:pos></aixm:ElevatedPoint></aixm:ARP></aixm:AirportHeliportTimeSlice></aixm:timeSlice></aixm:AirportHeliport></aerodrome><validPeriod><gml:TimePeriod gml:id="uuid.b5bb3991-c7dc-43e8-aa11-1849bb41145f"><gml:beginPosition>2020-06-15T18:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></validPeriod><baseForecast><MeteorologicalAerodromeForecast cloudAndVisibilityOK="false" gml:id="uuid.6b1ab8a2-b948-444b-9eda-d0c77ea20c51"><phenomenonTime><gml:TimePeriod gml:id="uuid.8a08c161-6f5a-4217-ba3c-d77494bdab63"><gml:beginPosition>2020-06-15T17:29:00Z</gml:beginPosition><gml:endPosition>2020-06-16T05:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">60</meanWindDirection><meanWindSpeed uom="[kn_i]">8</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.e88296e6-c4f4-41a6-a448-c725d4aad748"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/0"/><base nilReason="http://codes.wmo.int/common/nill/inapplicable" uom="N/A" xsi:nil="true"/></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></baseForecast><changeForecast><MeteorologicalAerodromeForecast changeIndicator="FROM" cloudAndVisibilityOK="false" gml:id="uuid.5e95a607-3e61-4e39-96b4-7e95674597be"><phenomenonTime><gml:TimePeriod gml:id="uuid.a4ab7504-4ffa-4b69-9d87-3c60cb690614"><gml:beginPosition>2020-06-16T05:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T14:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">100</meanWindDirection><meanWindSpeed uom="[kn_i]">3</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.dd4c456f-daa0-4fd4-82c2-a84d2764c560"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/1"/><base uom="[ft_i]">5000</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></changeForecast><changeForecast><MeteorologicalAerodromeForecast changeIndicator="FROM" cloudAndVisibilityOK="false" gml:id="uuid.96e4900a-6618-4e0a-9fb5-4cb72c7f01ed"><phenomenonTime><gml:TimePeriod gml:id="uuid.88705462-4b5a-45d5-8184-1c68897ed186"><gml:beginPosition>2020-06-16T14:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">150</meanWindDirection><meanWindSpeed uom="[kn_i]">4</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.219d3e54-ad87-485c-8ccc-488622e38281"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/1"/><base uom="[ft_i]">4000</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></changeForecast><extension><USMetadata xmlns="http://www.weather.gov/iwxxm-us/3.0" xsi:schemaLocation="http://www.weather.gov/iwxxm-us/3.0 https://nws.weather.gov/schemas/iwxxm-us/3.0/taf.xsd"><procedure xlink:href="https://www.nws.noaa.gov/directives/sym/pd01008013curr.pdf" xlink:title="NWS Instruction 10-813, Aviation Weather Services, Terminal Aerodrome Forecasts"/></USMetadata></extension></TAF></meteorologicalInformation><meteorologicalInformation><TAF gml:id="uuid.4d77f421-db50-4355-8e41-ef32576403d9" permissibleUsage="OPERATIONAL" reportStatus="NORMAL" xmlns="http://icao.int/iwxxm/3.0" xmlns:aixm="http://www.aixm.aero/schema/5.1.1" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://icao.int/iwxxm/3.0 https://schemas.wmo.int/iwxxm/3.0/iwxxm.xsd"><issueTime><gml:TimeInstant gml:id="uuid.23fa0713-1c8c-450c-bed2-4acee78b5eb5"><gml:timePosition>2020-06-15T17:29:00Z</gml:timePosition></gml:TimeInstant></issueTime><aerodrome><aixm:AirportHeliport gml:id="uuid.4e773075-635d-48cf-beac-a2dabe033304"><aixm:timeSlice><aixm:AirportHeliportTimeSlice gml:id="uuid.196daf61-6b9a-4d65-8ce3-b2c9501b0cdf"><gml:validTime/><aixm:interpretation>SNAPSHOT</aixm:interpretation><aixm:locationIndicatorICAO>KFWA</aixm:locationIndicatorICAO><aixm:ARP><aixm:ElevatedPoint axisLabels="Lat Long" gml:id="uuid.c00b8314-c8ee-4643-923c-6b37a34a6683" srsDimension="2" srsName="http://www.opengis.net/def/crs/EPSG/0/4326"><gml:pos>41.01 -85.20</gml:pos></aixm:ElevatedPoint></aixm:ARP></aixm:AirportHeliportTimeSlice></aixm:timeSlice></aixm:AirportHeliport></aerodrome><validPeriod><gml:TimePeriod gml:id="uuid.7fb14cd7-2b8c-441a-bcd3-3517e7fb1408"><gml:beginPosition>2020-06-15T18:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></validPeriod><baseForecast><MeteorologicalAerodromeForecast cloudAndVisibilityOK="false" gml:id="uuid.94139a95-d1d4-4d7b-9be7-b715cb4ab683"><phenomenonTime><gml:TimePeriod gml:id="uuid.2df27717-0ccd-4a97-99aa-5362f53a71b3"><gml:beginPosition>2020-06-15T17:29:00Z</gml:beginPosition><gml:endPosition>2020-06-16T15:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">60</meanWindDirection><meanWindSpeed uom="[kn_i]">9</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.8074ccdb-85fa-4445-b276-0605808ae646"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/2"/><base uom="[ft_i]">3500</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></baseForecast><changeForecast><MeteorologicalAerodromeForecast changeIndicator="FROM" cloudAndVisibilityOK="false" gml:id="uuid.58aa3d99-eb91-43bf-8498-78fa11a8009e"><phenomenonTime><gml:TimePeriod gml:id="uuid.5b5a9b8e-48aa-4be8-b1f3-993beeab6312"><gml:beginPosition>2020-06-16T15:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">80</meanWindDirection><meanWindSpeed uom="[kn_i]">5</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.9ca955d9-4444-4b33-8c37-12361e42b82f"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/1"/><base uom="[ft_i]">5000</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></changeForecast><extension><USMetadata xmlns="http://www.weather.gov/iwxxm-us/3.0" xsi:schemaLocation="http://www.weather.gov/iwxxm-us/3.0 https://nws.weather.gov/schemas/iwxxm-us/3.0/taf.xsd"><procedure xlink:href="https://www.nws.noaa.gov/directives/sym/pd01008013curr.pdf" xlink:title="NWS Instruction 10-813, Aviation Weather Services, Terminal Aerodrome Forecasts"/></USMetadata></extension></TAF></meteorologicalInformation><bulletinIdentifier>A_LTUS43KIWX151700_C_KIWX_202015172936.xml</bulletinIdentifier></MeteorologicalBulletin>
'''  # noqa: E501


IWXXM_PART1 = b'''\
<?xml version='1.0' encoding='UTF-8'?>
<MeteorologicalBulletin gml:id="uuid.f80d5b79-2821-4352-9d0b-1bdf3b9fcf49" xmlns="http://def.wmo.int/collect/2014" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://def.wmo.int/collect/2014 http://schemas.wmo.int/collect/1.2/collect.xsd"><meteorologicalInformation><TAF gml:id="uuid.430664ac-435a-4a15-8119-61fd45ea43ba" permissibleUsage="OPERATIONAL" reportStatus="NORMAL" xmlns="http://icao.int/iwxxm/3.0" xmlns:aixm="http://www.aixm.aero/schema/5.1.1" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://icao.int/iwxxm/3.0 https://schemas.wmo.int/iwxxm/3.0/iwxxm.xsd"><issueTime><gml:TimeInstant gml:id="uuid.fd5b765c-0e03-44af-a020-6a822f0acc6a"><gml:timePosition>2020-06-15T17:29:00Z</gml:timePosition></gml:TimeInstant></issueTime><aerodrome><aixm:AirportHeliport gml:id="uuid.6ccc4302-fded-49a8-85b1-7fd22cb1eb36"><aixm:timeSlice><aixm:AirportHeliportTimeSlice gml:id="uuid.378f76e2-ca0d-4962-a39a-ccf8f247d819"><gml:validTime/><aixm:interpretation>SNAPSHOT</aixm:interpretation><aixm:locationIndicatorICAO>KSBN</aixm:locationIndicatorICAO><aixm:ARP><aixm:ElevatedPoint axisLabels="Lat Long" gml:id="uuid.3423aa30-fcfe-478c-b0da-b132d3df616b" srsDimension="2" srsName="http://www.opengis.net/def/crs/EPSG/0/4326"><gml:pos>41.71 -86.32</gml:pos></aixm:ElevatedPoint></aixm:ARP></aixm:AirportHeliportTimeSlice></aixm:timeSlice></aixm:AirportHeliport></aerodrome><validPeriod><gml:TimePeriod gml:id="uuid.b5bb3991-c7dc-43e8-aa11-1849bb41145f"><gml:beginPosition>2020-06-15T18:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></validPeriod><baseForecast><MeteorologicalAerodromeForecast cloudAndVisibilityOK="false" gml:id="uuid.6b1ab8a2-b948-444b-9eda-d0c77ea20c51"><phenomenonTime><gml:TimePeriod gml:id="uuid.8a08c161-6f5a-4217-ba3c-d77494bdab63"><gml:beginPosition>2020-06-15T17:29:00Z</gml:beginPosition><gml:endPosition>2020-06-16T05:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">60</meanWindDirection><meanWindSpeed uom="[kn_i]">8</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.e88296e6-c4f4-41a6-a448-c725d4aad748"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/0"/><base nilReason="http://codes.wmo.int/common/nill/inapplicable" uom="N/A" xsi:nil="true"/></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></baseForecast><changeForecast><MeteorologicalAerodromeForecast changeIndicator="FROM" cloudAndVisibilityOK="false" gml:id="uuid.5e95a607-3e61-4e39-96b4-7e95674597be"><phenomenonTime><gml:TimePeriod gml:id="uuid.a4ab7504-4ffa-4b69-9d87-3c60cb690614"><gml:beginPosition>2020-06-16T05:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T14:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">100</meanWindDirection><meanWindSpeed uom="[kn_i]">3</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.dd4c456f-daa0-4fd4-82c2-a84d2764c560"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/1"/><base uom="[ft_i]">5000</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></changeForecast><changeForecast><MeteorologicalAerodromeForecast changeIndicator="FROM" cloudAndVisibilityOK="false" gml:id="uuid.96e4900a-6618-4e0a-9fb5-4cb72c7f01ed"><phenomenonTime><gml:TimePeriod gml:id="uuid.88705462-4b5a-45d5-8184-1c68897ed186"><gml:beginPosition>2020-06-16T14:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">150</meanWindDirection><meanWindSpeed uom="[kn_i]">4</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.219d3e54-ad87-485c-8ccc-488622e38281"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/1"/><base uom="[ft_i]">4000</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></changeForecast><extension><USMetadata xmlns="http://www.weather.gov/iwxxm-us/3.0" xsi:schemaLocation="http://www.weather.gov/iwxxm-us/3.0 https://nws.weather.gov/schemas/iwxxm-us/3.0/taf.xsd"><procedure xlink:href="https://www.nws.noaa.gov/directives/sym/pd01008013curr.pdf" xlink:title="NWS Instruction 10-813, Aviation Weather Services, Terminal Aerodrome Forecasts"/></USMetadata></extension></TAF></meteorologicalInformation><bulletinIdentifier>A_LTUS43KIWX151700_C_KIWX_202015172936.xml</bulletinIdentifier></MeteorologicalBulletin>
'''  # noqa: E501


IWXXM_PART2 = b'''\
<?xml version='1.0' encoding='UTF-8'?>
<MeteorologicalBulletin gml:id="uuid.f80d5b79-2821-4352-9d0b-1bdf3b9fcf49" xmlns="http://def.wmo.int/collect/2014" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://def.wmo.int/collect/2014 http://schemas.wmo.int/collect/1.2/collect.xsd"><meteorologicalInformation><TAF gml:id="uuid.4d77f421-db50-4355-8e41-ef32576403d9" permissibleUsage="OPERATIONAL" reportStatus="NORMAL" xmlns="http://icao.int/iwxxm/3.0" xmlns:aixm="http://www.aixm.aero/schema/5.1.1" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://icao.int/iwxxm/3.0 https://schemas.wmo.int/iwxxm/3.0/iwxxm.xsd"><issueTime><gml:TimeInstant gml:id="uuid.23fa0713-1c8c-450c-bed2-4acee78b5eb5"><gml:timePosition>2020-06-15T17:29:00Z</gml:timePosition></gml:TimeInstant></issueTime><aerodrome><aixm:AirportHeliport gml:id="uuid.4e773075-635d-48cf-beac-a2dabe033304"><aixm:timeSlice><aixm:AirportHeliportTimeSlice gml:id="uuid.196daf61-6b9a-4d65-8ce3-b2c9501b0cdf"><gml:validTime/><aixm:interpretation>SNAPSHOT</aixm:interpretation><aixm:locationIndicatorICAO>KFWA</aixm:locationIndicatorICAO><aixm:ARP><aixm:ElevatedPoint axisLabels="Lat Long" gml:id="uuid.c00b8314-c8ee-4643-923c-6b37a34a6683" srsDimension="2" srsName="http://www.opengis.net/def/crs/EPSG/0/4326"><gml:pos>41.01 -85.20</gml:pos></aixm:ElevatedPoint></aixm:ARP></aixm:AirportHeliportTimeSlice></aixm:timeSlice></aixm:AirportHeliport></aerodrome><validPeriod><gml:TimePeriod gml:id="uuid.7fb14cd7-2b8c-441a-bcd3-3517e7fb1408"><gml:beginPosition>2020-06-15T18:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></validPeriod><baseForecast><MeteorologicalAerodromeForecast cloudAndVisibilityOK="false" gml:id="uuid.94139a95-d1d4-4d7b-9be7-b715cb4ab683"><phenomenonTime><gml:TimePeriod gml:id="uuid.2df27717-0ccd-4a97-99aa-5362f53a71b3"><gml:beginPosition>2020-06-15T17:29:00Z</gml:beginPosition><gml:endPosition>2020-06-16T15:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">60</meanWindDirection><meanWindSpeed uom="[kn_i]">9</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.8074ccdb-85fa-4445-b276-0605808ae646"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/2"/><base uom="[ft_i]">3500</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></baseForecast><changeForecast><MeteorologicalAerodromeForecast changeIndicator="FROM" cloudAndVisibilityOK="false" gml:id="uuid.58aa3d99-eb91-43bf-8498-78fa11a8009e"><phenomenonTime><gml:TimePeriod gml:id="uuid.5b5a9b8e-48aa-4be8-b1f3-993beeab6312"><gml:beginPosition>2020-06-16T15:00:00Z</gml:beginPosition><gml:endPosition>2020-06-16T18:00:00Z</gml:endPosition></gml:TimePeriod></phenomenonTime><prevailingVisibility uom="m">10000</prevailingVisibility><prevailingVisibilityOperator>ABOVE</prevailingVisibilityOperator><surfaceWind><AerodromeSurfaceWindForecast variableWindDirection="false"><meanWindDirection uom="deg">80</meanWindDirection><meanWindSpeed uom="[kn_i]">5</meanWindSpeed></AerodromeSurfaceWindForecast></surfaceWind><cloud><AerodromeCloudForecast gml:id="uuid.9ca955d9-4444-4b33-8c37-12361e42b82f"><layer><CloudLayer><amount xlink:href="http://codes.wmo.int/bufr4/codeflag/0-20-008/1"/><base uom="[ft_i]">5000</base></CloudLayer></layer></AerodromeCloudForecast></cloud></MeteorologicalAerodromeForecast></changeForecast><extension><USMetadata xmlns="http://www.weather.gov/iwxxm-us/3.0" xsi:schemaLocation="http://www.weather.gov/iwxxm-us/3.0 https://nws.weather.gov/schemas/iwxxm-us/3.0/taf.xsd"><procedure xlink:href="https://www.nws.noaa.gov/directives/sym/pd01008013curr.pdf" xlink:title="NWS Instruction 10-813, Aviation Weather Services, Terminal Aerodrome Forecasts"/></USMetadata></extension></TAF></meteorologicalInformation><bulletinIdentifier>A_LTUS43KIWX151700_C_KIWX_202015172936.xml</bulletinIdentifier></MeteorologicalBulletin>
'''  # noqa: E501
